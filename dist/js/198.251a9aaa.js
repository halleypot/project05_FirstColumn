"use strict";(self["webpackChunkheimatoutiao"]=self["webpackChunkheimatoutiao"]||[]).push([[198],{2198:function(t,e,s){s.r(e),s.d(e,{default:function(){return u}});var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"search"},[e("van-nav-bar",{attrs:{title:"搜索中心","left-arrow":""},on:{"click-left":function(e){return t.$router.go(-1)}}}),e("form",[e("van-search",{attrs:{"show-action":"",autofocus:"",shape:"round",placeholder:"请输入搜索关键词"},on:{input:t.getTips},scopedSlots:t._u([{key:"action",fn:function(){return[e("div",{on:{click:t.onSearch}},[t._v("搜索")])]},proxy:!0}]),model:{value:t.key,callback:function(e){t.key=e},expression:"key"}})],1),t.key?e("van-cell-group",[e("van-cell",{attrs:{title:"搜索提示"}}),t._l(t.associationList,(function(s,i){return e("van-cell",{key:i,on:{click:function(e){return t.toResult(s)}},scopedSlots:t._u([{key:"title",fn:function(){return[e("span",{domProps:{innerHTML:t._s(s)}})]},proxy:!0}],null,!0)})}))],2):e("van-cell-group",[e("van-cell",{attrs:{title:"历史记录"},scopedSlots:t._u([{key:"default",fn:function(){return[e("van-icon",{attrs:{name:"cross"},on:{click:t.clearHistory}})]},proxy:!0}],null,!1,1646123767)}),t._l(t.history,(function(t,s){return e("van-cell",{key:s,attrs:{title:t}})}))],2)],1)},o=[],r=s(3571),n={data(){return{key:"",associationList:[],timerId:null,history:JSON.parse(localStorage.getItem("history"))||[]}},methods:{toResult(t){console.log(t);const e=new RegExp(`<span style="color:red">${this.key}</span>`,"ig");t=t.replace(e,this.key),this.$router.push(`/search/result?key=${t}`)},getTips(){clearTimeout(this.timerId),this.key.trim()&&(this.timerId=setTimeout((async()=>{const t=await(0,r.pO)({q:this.key});console.log(t);let e=new RegExp(this.key,"ig");this.associationList=t.data.data.options.map((t=>t?t.replace(e,`<span style="color:red">${this.key}</span>`):""))}),500))},onSearch(){this.history.unshift(this.key),this.history=[...new Set(this.history)],this.history.length>5&&this.history.splice(5),localStorage.setItem("history",JSON.stringify(this.history)),this.$router.push(`/search/result?key=${this.key}`),this.key=""},clearHistory(){this.$dialog.confirm({title:"警告⚠",message:"确认删除？"}).then((()=>{this.history=[]})).catch((()=>{}))}}},a=n,l=s(1001),c=(0,l.Z)(a,i,o,!1,null,"2d405c8b",null),u=c.exports}}]);