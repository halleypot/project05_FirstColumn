"use strict";(self["webpackChunkheimatoutiao"]=self["webpackChunkheimatoutiao"]||[]).push([[319],{3319:function(t,e,n){n.r(e),n.d(e,{default:function(){return u}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"comment"},[e("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.commentList,(function(n,s){return e("van-cell",{key:s,scopedSlots:t._u([{key:"title",fn:function(){return[e("div",{staticClass:"readerComment"},[e("van-image",{attrs:{width:"40",height:"40",src:n.aut_photo,round:"",fit:"cover"}}),e("div",{staticClass:"reader"},[e("div",{staticClass:"readerName"},[t._v(t._s(n.aut_name))]),e("div",{staticClass:"opinion"},[t._v(t._s(n.content))]),e("div",{staticClass:"other"},[t._v(" "+t._s(t._f("timeFormat")(n.pubdate))+" "),e("van-button",{staticClass:"btnReply",attrs:{size:"mini",round:""},on:{click:function(e){return t.toReply(n)}}},[t._v("回复`("+t._s(n.reply_count)+")` ")])],1)])],1)]},proxy:!0},{key:"right-icon",fn:function(){return[e("van-icon",{attrs:{name:"like-o"}})]},proxy:!0}],null,!0)})})),1),e("van-field",{ref:"iptComment",attrs:{placeholder:"please input your comments"},scopedSlots:t._u([{key:"button",fn:function(){return[e("van-button",{attrs:{size:"small",type:"info"},on:{click:t.publish}},[t._v("发布")])]},proxy:!0}]),model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),e("van-action-sheet",{attrs:{title:"发表回复"},model:{value:t.openReply,callback:function(e){t.openReply=e},expression:"openReply"}},[t.openReply?e("reply",{attrs:{currentCom:t.currentCom}}):t._e()],1)],1)},i=[],o=n(3571),a={props:["art_id"],components:{reply:()=>n.e(761).then(n.bind(n,3761))},data(){return{content:"",loading:!1,finished:!1,offset:"",end:"",commentList:[],openReply:!1,currentCom:""}},methods:{toReply(t){this.currentCom=t,this.openReply=!0},async publish(){const t=await(0,o.pw)({target:this.art_id,content:this.content});this.$toast.success("评论成功！"),this.commentList.unshift(t.data.data.new_obj),this.content=""},async onLoad(){const t=await(0,o.mI)({type:"a",source:this.art_id,offset:""});this.commentList.push(...t.data.data.results),this.offset=t.data.data.last_id,this.end=t.data.data.end_id,this.loading=!1,this.offset===this.end&&(this.finished=!0)}},async created(){setTimeout((()=>{this.$refs.iptComment.focus()}),500)}},c=a,r=n(1001),l=(0,r.Z)(c,s,i,!1,null,null,null),u=l.exports}}]);